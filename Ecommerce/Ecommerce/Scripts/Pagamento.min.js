var removerCSSBordaFrete;function CarregarCEP(e){e.length>0&&$.ajax({type:"GET",url:"https://viacep.com.br/ws/"+e+"/json/",success:function(e){JSON.stringify(e).indexOf("cep")>0&&($('input[name="Logradouro"]').val(e.logradouro),$('input[name="Complemento"]').val(e.complemento),$('input[name="Bairro"]').val(e.bairro),$('input[name="Cidade"]').val(e.localidade),$('select[name="UF"]').val(e.uf))},error:function(e){console.log(e)}})}function PopularEndereco(e){$("input[name='CEP']").val(e.CEP),$("input[name='Logradouro']").val(e.Logradouro),$("input[name='Numero']").val(e.Numero),$("input[name='Complemento']").val(e.Complemento),$("input[name='Bairro']").val(e.Bairro),$("input[name='Cidade']").val(e.Cidade),$("select[name='UF']").val(e.UF),$("#endereco").empty(),$("#endereco").append(e.Logradouro+", "+e.Numero+(null!=e.Complemento&&""!=e.Complemento?", "+e.Complemento:"")+"<br>"+e.Bairro+", "+e.Cidade+"-"+e.UF+", "+e.CEP)}function SalvarEndereco(){if($("#iconBtnSalvar").fadeIn(0),ValidarEndereco()){var e={CEP:$("input[name='CEP']").val().trim(),Logradouro:$("input[name='Logradouro']").val(),Numero:$("input[name='Numero']").val(),Complemento:$("input[name='Complemento']").val(),Bairro:$("input[name='Bairro']").val(),Cidade:$("input[name='Cidade']").val(),UF:$("select[name='UF']").val()};$.ajax({type:"POST",url:"/Usuario/SalvarEnderecoCobranca",data:e,success:function(e){e.sucesso?($("#divAlterarEndereco").fadeOut(0),$("#divEndereco").fadeIn(),$("#iconBtnSalvar").fadeOut(0),PopularEndereco(e.obj),UpScroll()):($("#iconBtnSalvar").fadeOut(0),swal("Atenção",e.mensagem,"error"))},error:function(e){swal("Atenção","Erro ao tentar conectar-se ao servidor. Tente novamente.","error"),$("#iconBtnSalvar").fadeOut(0)}})}else $("#iconBtnSalvar").fadeOut(0)}function ObterUsuario(){$.ajax({type:"GET",url:"/Usuario/Obter",success:function(e){e.sucesso&&(PopularEndereco(e.obj.EnderecoCobranca),ObterCarrinho())}})}function ValidarEndereco(){var e=!0,r=$("input[name='CEP']").val().trim(),a=$("input[name='Logradouro']").val().trim(),o=$("input[name='Numero']").val().trim(),n=$("input[name='Complemento']").val().trim(),i=$("input[name='Bairro']").val().trim(),t=$("input[name='Cidade']").val().trim(),d=$("select[name='UF']").val().trim();return r.length<=0||r.length>8?($("input[name='CEP']").css("border","1px solid red"),e=!1):$("input[name='CEP']").css("border","1px solid #e6e6e6"),a.length<=0||a.length>100?($("input[name='Logradouro']").css("border","1px solid red"),e=!1):$("input[name='Logradouro']").css("border","1px solid #e6e6e6"),o.length<=0||o.length>10?($("input[name='Numero']").css("border","1px solid red"),e=!1):$("input[name='Numero']").css("border","1px solid #e6e6e6"),n.length>50?($("input[name='Complemento']").css("border","1px solid red"),e=!1):$("input[name='Complemento']").css("border","1px solid #e6e6e6"),i.length<=0||i.length>45?($("input[name='Bairro']").css("border","1px solid red"),e=!1):$("input[name='Bairro']").css("border","1px solid #e6e6e6"),t.length<=0||t.length>32?($("input[name='Cidade']").css("border","1px solid red"),e=!1):$("input[name='Cidade']").css("border","1px solid #e6e6e6"),"0"==d||d.length>2||d.length<=0?($("select[name='UF']").css("border","1px solid red"),e=!1):$("select[name='UF']").css("border","1px solid #e6e6e6"),e}function FinalizarPagamento(){var e=$("#numero").val().trim(),r=$("#cvc").val().trim(),a=$("#mes").val().trim(),o=$("#ano").val().trim(),n=$("#nome").val().trim(),i=$("#dataNascimento").val().trim(),t=$("#cpf").val().trim(),d=$("#parcelas").val(),s=$("#codPedidoCripto").val(),l=$("#idWirecardPedidoCripto").val();(function(){if($('input[name="formaPagamento"]')[0].checked){var s=!0;return n.length<=0?(s=!1,$("#nome").css("border","1px solid red")):$("#nome").css("border","1px solid #e6e6e6"),e.length<10?(s=!1,$("#numero").css("border","1px solid red")):$("#numero").css("border","1px solid #e6e6e6"),r.length<=0?(s=!1,$("#cvc").css("border","1px solid red")):$("#cvc").css("border","1px solid #e6e6e6"),a.length<=0?(s=!1,$("#mes").css("border","1px solid red")):$("#mes").css("border","1px solid #e6e6e6"),o.length<=0?(s=!1,$("#ano").css("border","1px solid red")):$("#ano").css("border","1px solid #e6e6e6"),parseInt(d)<=0?(s=!1,$("#parcelas").css("border","1px solid red")):$("#parcelas").css("border","1px solid #e6e6e6"),ValidarData(i)?$("#dataNascimento").css("border","1px solid #e6e6e6"):(s=!1,$("#dataNascimento").css("border","1px solid red")),ValidarCPF(t)?$("#cpf").css("border","1px solid #e6e6e6"):(s=!1,$("#cpf").css("border","1px solid red")),s}return!0})()?$('input[name="formaPagamento"]')[0].checked?function(){$("#iconBtnFinalizar").fadeIn(0);var c=new Moip.CreditCard({number:e,cvc:r,expMonth:a,expYear:o,pubKey:atob($("#public_key").val())});if(c.isValid()){var m={Nome:n,CPF:t,DataNascimento:i,Parcelas:d,Hash:c.hash().toString(),CodPedidoCripto:s,IdWirecardPedidoCripto:l,Boleto:!1};$.ajax({type:"POST",url:"/Pagamento/Finalizar",data:m,success:function(e){e.sucesso?window.location.href=`/Pedido/${e.obj.CodPedido}`:($("#iconBtnFinalizar").fadeOut(0),swal("Atenção",e.mensagem,"error"))},error:function(e){$("#iconBtnFinalizar").fadeOut(0),swal("Atenção","Erro ao tentar conectar-se ao servidor. Tente novamente.","error")}})}else $("#iconBtnFinalizar").fadeOut(0),swal("Atenção","Dados do cartão de crédito incorretos.","error")}():function(){$("#iconBtnFinalizar").fadeIn(0);var e={CodPedidoCripto:s,IdWirecardPedidoCripto:l,Boleto:!0};$.ajax({type:"POST",url:"/Pagamento/Finalizar",data:e,success:function(e){e.sucesso?window.location.href=`/Pedido/${e.obj.CodPedido}`:(swal("Atenção",e.mensagem,"error"),$("#iconBtnFinalizar").fadeOut(0))},error:function(e){$("#iconBtnFinalizar").fadeOut(0),swal("Atenção","Erro ao tentar conectar-se ao servidor. Tente novamente.","error")}})}():UpScroll()}function ValidarData(e){if(null==e||e.length<10)return!1;var r=e.substr(0,2),a=e.substr(3,2),o=e.substr(6,4);return!(r>31||r<=0||a>12||a<=0||o<1850)}function ValidarCPF(e){if(e<14)return!1;var r,a;if(r=0,"00000000000"==(e=e.replace(".","").replace(".","").replace("-","")))return!1;for(i=1;i<=9;i++)r+=parseInt(e.substring(i-1,i))*(11-i);if(10!=(a=10*r%11)&&11!=a||(a=0),a!=parseInt(e.substring(9,10)))return!1;for(r=0,i=1;i<=10;i++)r+=parseInt(e.substring(i-1,i))*(12-i);return 10!=(a=10*r%11)&&11!=a||(a=0),a==parseInt(e.substring(10,11))}$(()=>{ObterUsuario(),$("#numero").mask("0000 0000 0000 0000"),$("#mes").mask("00"),$("#ano").mask("00"),$("#cvc").mask("0000"),$("#dataNascimento").mask("00/00/0000"),$("#cpf").mask("00000000000"),$('input[name="CEP"]').mask("000000000"),null!=removerCSSBordaFrete&&removerCSSBordaFrete&&$("#divFrete").removeClass("bor12")});